(this["webpackJsonpigj-frontend"]=this["webpackJsonpigj-frontend"]||[]).push([[59],{960:function(e,a,s){},991:function(e,a,s){"use strict";s.r(a);var t=s(8),c=s(0),l=s.n(c),r=s(403),i=s(818),n=s(812),o=s(404),j=s(864),d=s(817),O=s(816),b=s(22),m=s(240),u=s.n(m),p=s(1);const h=e=>{let{filter:a,setFilter:s}=e;const[t,l]=Object(c.useState)(a),r=Object(O.useAsyncDebounce)(e=>{s(e||void 0)},1e3);return Object(p.jsxs)("span",{className:"d-flex align-items-center justify-content-end",children:["Procurar:"," ",Object(p.jsx)("input",{className:"form-control ml-2 w-auto",value:t||"",onChange:e=>{l(e.target.value),r(e.target.value)}})]})};var x=s(814),g=s(820),v=s.n(g);var f=e=>{let{fields:a,selectedFields:s,onChange:c,readonly:l}=e;const r=s.length;if(l){const e=[...s].sort((e,a)=>(parseInt(e.ORDEM)||0)-(parseInt(a.ORDEM)||0));return 0===e.length?Object(p.jsx)("div",{className:"text-center py-3",children:Object(p.jsx)("span",{style:{color:"#636E72",fontSize:13},children:"Nenhum campo configurado"})}):Object(p.jsx)("div",{className:"field-config-panel",children:e.map((e,s)=>{const t=a.find(a=>a.ID===e.PR_CAMPOS_ID);return Object(p.jsxs)("div",{className:"field-view-row",children:[Object(p.jsx)("span",{className:"field-order",children:e.ORDEM||"-"}),Object(p.jsx)("span",{className:"field-name",children:(null===t||void 0===t?void 0:t.DESIG)||e.PR_CAMPOS_ID}),Object(p.jsx)("span",{className:"obrig-tag ".concat("1"===e.FLAG_OBRIGATORIEDADE?"sim":"nao"),children:"1"===e.FLAG_OBRIGATORIEDADE?"Obrigat\xf3rio":"Opcional"})]},s)})})}return Object(p.jsxs)("div",{className:"field-config-panel",children:[Object(p.jsxs)("div",{className:"section-label",children:[Object(p.jsx)("i",{className:"feather icon-layers"}),"Campos do Ecr\xe3",Object(p.jsxs)("span",{className:"field-counter",children:[r," de ",a.length," selecionados"]})]}),a.map((e,a)=>{const l=(r=e.ID,s.some(e=>e.PR_CAMPOS_ID===r));var r;const i=(e=>s.find(a=>a.PR_CAMPOS_ID===e))(e.ID);return Object(p.jsxs)("div",{className:"field-row ".concat(l?"active":""),children:[Object(p.jsxs)("label",{className:"toggle-switch",children:[Object(p.jsx)("input",{type:"checkbox",checked:l,onChange:a=>((e,a)=>{if(a){const a=[...s,{ID:null,PR_CAMPOS_ID:e.ID,FLAG_OBRIGATORIEDADE:"0",ESTADO:"1",ORDEM:""}];c(a)}else c(s.filter(a=>a.PR_CAMPOS_ID!==e.ID))})(e,a.target.checked)}),Object(p.jsx)("span",{className:"slider"})]}),Object(p.jsx)("span",{className:"field-name",children:e.DESIG}),Object(p.jsxs)("div",{className:"field-controls",children:[Object(p.jsx)("span",{className:"order-label",children:"Ordem:"}),Object(p.jsx)("input",{type:"number",className:"order-input",min:"1",max:"99",value:(null===i||void 0===i?void 0:i.ORDEM)||"",onChange:a=>((e,a)=>{const l=parseInt(a);""===a||isNaN(l)?c(s.map(a=>a.PR_CAMPOS_ID===e?Object(t.a)(Object(t.a)({},a),{},{ORDEM:""}):a)):l>=1&&l<=99?c(s.map(a=>a.PR_CAMPOS_ID===e?Object(t.a)(Object(t.a)({},a),{},{ORDEM:l.toString()}):a)):u.a.error("Escolha um n\xfamero entre 1 e 99",{duration:3e3})})(e.ID,a.target.value),placeholder:"-"}),Object(p.jsx)("button",{type:"button",className:"obrig-badge ".concat("1"===(null===i||void 0===i?void 0:i.FLAG_OBRIGATORIEDADE)?"active":"inactive"),onClick:()=>(e=>{c(s.map(a=>a.PR_CAMPOS_ID===e?Object(t.a)(Object(t.a)({},a),{},{FLAG_OBRIGATORIEDADE:"1"===a.FLAG_OBRIGATORIEDADE?"0":"1"}):a))})(e.ID),title:"1"===(null===i||void 0===i?void 0:i.FLAG_OBRIGATORIEDADE)?"Clique para tornar opcional":"Clique para tornar obrigat\xf3rio",children:"1"===(null===i||void 0===i?void 0:i.FLAG_OBRIGATORIEDADE)?"Obrig.":"Opcional"})]})]},e.ID||a)})]})};const D={criar:"Criar Pe\xe7a Processual",editar:"Editar Pe\xe7a Processual",ver:"Visualizar Pe\xe7a Processual"};var N=e=>{let{show:a,mode:s,item:t,fields:l,onHide:i,onSave:j}=e;const d=Object(c.useRef)(null),[O,b]=Object(c.useState)(""),[m,u]=Object(c.useState)(""),[h,g]=Object(c.useState)([]);Object(c.useEffect)(()=>{if(a)if("criar"===s)b(""),u(""),g([]);else if(t){b(t.DESIG||""),u(t.OBS||"");const e=(t.sgigjrelpecaprocessualcampo||[]).map(e=>({ID:e.ID,PR_CAMPOS_ID:e.PR_CAMPOS_ID,FLAG_OBRIGATORIEDADE:e.FLAG_OBRIGATORIEDADE,ESTADO:e.ESTADO,ORDEM:e.ORDEM?e.ORDEM.toString():""}));g(e)}},[a,s,t]);const N="ver"===s;return Object(p.jsxs)(x.a,{size:"xl",show:a,onHide:i,className:"peca-modal",centered:!0,children:[Object(p.jsx)(x.a.Header,{closeButton:!0,children:Object(p.jsx)(x.a.Title,{as:"h5",children:D[s]||"Pe\xe7a Processual"})}),Object(p.jsx)(x.a.Body,{children:Object(p.jsxs)("form",{id:"pecaForm",onSubmit:e=>{var a;e.preventDefault();const t=(null===d||void 0===d||null===(a=d.current)||void 0===a?void 0:a.value)||m;"criar"===s?j({PECA:{DESIG:O,OBS:t,ESTADO:"1"},CAMPOS:h}):"editar"===s&&j({DESIG:O,OBS:t,ESTADO:"1",CAMPOS:h})},children:[Object(p.jsxs)("div",{className:"section-label",children:[Object(p.jsx)("i",{className:"feather icon-file-text"}),"Dados Gerais"]}),Object(p.jsxs)(n.a,{children:[Object(p.jsx)(o.a,{sm:3,children:Object(p.jsxs)("div",{className:"form-group fill",children:[Object(p.jsx)("label",{className:"floating-label",children:"C\xf3digo"}),N?Object(p.jsx)("span",{className:"view-value",children:(null===t||void 0===t?void 0:t.CODIGO)||"-"}):Object(p.jsx)("input",{type:"text",className:"form-control",value:"editar"===s?(null===t||void 0===t?void 0:t.CODIGO)||"":"*",disabled:!0})]})}),Object(p.jsx)(o.a,{sm:9,children:Object(p.jsxs)("div",{className:"form-group fill",children:[Object(p.jsxs)("label",{className:"floating-label",children:["Designa\xe7\xe3o ",!N&&Object(p.jsx)("span",{style:{color:"#E74C3C"},children:"*"})]}),N?Object(p.jsx)("span",{className:"view-value",children:(null===t||void 0===t?void 0:t.DESIG)||"-"}):Object(p.jsx)("input",{type:"text",className:"form-control",maxLength:"128",value:O,onChange:e=>b(e.target.value),placeholder:"Designa\xe7\xe3o da pe\xe7a processual...",required:!0})]})})]}),Object(p.jsx)(n.a,{children:Object(p.jsx)(o.a,{sm:12,children:Object(p.jsxs)("div",{className:"form-group fill",children:[Object(p.jsx)("label",{className:"floating-label",children:"Descri\xe7\xe3o"}),N?Object(p.jsx)("div",{className:"view-html",dangerouslySetInnerHTML:{__html:(null===t||void 0===t?void 0:t.OBS)||"<em>Sem descri\xe7\xe3o</em>"}}):Object(p.jsx)(v.a,{value:m,config:{readonly:!1},ref:d})]})})}),Object(p.jsx)("div",{className:"mt-3",children:N?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("div",{className:"section-label",children:[Object(p.jsx)("i",{className:"feather icon-layers"}),"Campos Configurados",h.length>0&&Object(p.jsxs)("span",{className:"field-counter",children:[h.length," campos"]})]}),Object(p.jsx)(f,{fields:l,selectedFields:h,onChange:()=>{},readonly:!0})]}):Object(p.jsx)(f,{fields:l,selectedFields:h,onChange:g})})]})}),Object(p.jsxs)(x.a.Footer,{children:[Object(p.jsx)(r.a,{variant:"outline-secondary",onClick:i,children:"Fechar"}),!N&&Object(p.jsxs)(r.a,{type:"submit",form:"pecaForm",variant:"primary",children:[Object(p.jsx)("i",{className:"feather icon-save mr-1"}),"Guardar"]})]})]})},I=s(30),S=s(26),C=s(76);s(960);const P="/configuracao/pecasprocessuais";function E(e){const a=document.createElement("div");return a.innerHTML=e,a.textContent||a.innerText||""}function A(e){let{columns:a,data:s,modalOpen:c,loading:l,permissoes:n}=e;const{getTableProps:o,getTableBodyProps:j,headerGroups:b,prepareRow:m,globalFilter:u,setGlobalFilter:x,page:g,canPreviousPage:v,canNextPage:f,pageOptions:D,pageCount:N,gotoPage:I,nextPage:S,previousPage:E,setPageSize:A,state:{pageIndex:R,pageSize:y}}=Object(O.useTable)({columns:a,data:s,initialState:{pageIndex:0,pageSize:10}},O.useGlobalFilter,O.useSortBy,O.usePagination);return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("div",{className:"pecas-toolbar",children:[Object(p.jsxs)("div",{className:"toolbar-left",children:["Mostrar",Object(p.jsx)("select",{className:"form-control w-auto mx-1",value:y,onChange:e=>A(Number(e.target.value)),children:[5,10,20,30,40,50].map(e=>Object(p.jsx)("option",{value:e,children:e},e))}),"entradas"]}),Object(p.jsxs)("div",{className:"toolbar-right",children:[Object(p.jsx)(h,{filter:u,setFilter:x}),!1!==Object(C.s)(P,n,"Criar")&&Object(p.jsxs)("button",{className:"btn-add",onClick:c,children:[Object(p.jsx)("i",{className:"feather icon-plus"})," Adicionar"]})]})]}),l?Object(p.jsx)("div",{className:"pecas-skeleton",children:[1,2,3,4,5].map(e=>Object(p.jsxs)("div",{className:"skeleton-row",children:[Object(p.jsx)("div",{className:"skeleton-cell w-60"}),Object(p.jsx)("div",{className:"skeleton-cell w-180"}),Object(p.jsx)("div",{className:"skeleton-cell w-250"}),Object(p.jsx)("div",{className:"skeleton-cell w-80"})]},e))}):0===s.length?Object(p.jsxs)("div",{className:"pecas-empty-state",children:[Object(p.jsx)("i",{className:"feather icon-file-text"}),Object(p.jsx)("p",{children:"Nenhuma pe\xe7a processual configurada"}),!1!==Object(C.s)(P,n,"Criar")&&Object(p.jsxs)(r.a,{variant:"primary",size:"sm",onClick:c,children:[Object(p.jsx)("i",{className:"feather icon-plus mr-1"})," Adicionar Pe\xe7a"]})]}):Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)(d.a,Object(t.a)(Object(t.a)({striped:!0,bordered:!0,hover:!0,responsive:!0},o()),{},{children:[Object(p.jsx)("thead",{children:b.map(e=>Object(p.jsx)("tr",Object(t.a)(Object(t.a)({},e.getHeaderGroupProps()),{},{children:e.headers.map(e=>Object(p.jsxs)("th",Object(t.a)(Object(t.a)({},e.getHeaderProps(e.getSortByToggleProps())),{},{children:[e.render("Header"),Object(p.jsx)("span",{children:e.isSorted?e.isSortedDesc?Object(p.jsx)("span",{className:"feather icon-arrow-down text-muted float-right"}):Object(p.jsx)("span",{className:"feather icon-arrow-up text-muted float-right"}):""})]})))})))}),Object(p.jsx)("tbody",Object(t.a)(Object(t.a)({},j()),{},{children:g.map(e=>(m(e),Object(p.jsx)("tr",Object(t.a)(Object(t.a)({},e.getRowProps()),{},{children:e.cells.map(e=>Object(p.jsx)("td",Object(t.a)(Object(t.a)({},e.getCellProps()),{},{className:e.column.centered?"text-center":"",children:e.render("Cell")})))}))))}))]})),Object(p.jsxs)("div",{className:"pecas-pagination",children:[Object(p.jsxs)("div",{className:"page-info",children:["P\xe1gina ",Object(p.jsxs)("strong",{children:[R+1," de ",D.length]})," ","| Ir para:",Object(p.jsx)("input",{type:"number",defaultValue:R+1,onChange:e=>{const a=e.target.value?Number(e.target.value)-1:0;I(a)}})]}),Object(p.jsxs)(i.a,{children:[Object(p.jsx)(i.a.First,{onClick:()=>I(0),disabled:!v}),Object(p.jsx)(i.a.Prev,{onClick:()=>E(),disabled:!v}),Object(p.jsx)(i.a.Next,{onClick:()=>S(),disabled:!f}),Object(p.jsx)(i.a.Last,{onClick:()=>I(N-1),disabled:!f})]})]})]})]})}a.default=()=>{const{permissoes:e,popUp_removerItem:a,popUp_alertaOK:s}=Object(S.a)(),r=Object(b.g)(),[i,d]=Object(c.useState)([]),[O,m]=Object(c.useState)([]),[h,x]=Object(c.useState)(!0),[g,v]=Object(c.useState)([]),[f,D]=Object(c.useState)({show:!1,mode:null,item:null}),R=Object(c.useCallback)(async()=>{x(!0);try{const e=await I.a.get("/sgigjprpecasprocessual");200===e.status&&d(e.data)}catch(e){}finally{x(!1)}},[]),y=Object(c.useCallback)(async()=>{try{const e=await I.a.get("/sigjprcampo");200===e.status&&m(e.data)}catch(e){}},[]);Object(c.useEffect)(()=>{!1===Object(C.l)(P,e)?r.push("/"):(R(),y())},[]),Object(c.useEffect)(()=>{const a=i.map(a=>Object(t.a)(Object(t.a)({},a),{},{OBS_DISPLAY:E(a.OBS||"").slice(0,80),action:Object(p.jsxs)(l.a.Fragment,{children:[!1!==Object(C.s)(P,e,"Ler")&&Object(p.jsx)("button",{className:"action-btn action-view",title:Object(C.u)(P,e,"Ler"),onClick:()=>G("ver",a),children:Object(p.jsx)("i",{className:Object(C.t)(P,e,"Ler")})}),!1!==Object(C.s)(P,e,"Editar")&&Object(p.jsx)("button",{className:"action-btn action-edit",title:Object(C.u)(P,e,"Editar"),onClick:()=>G("editar",a),children:Object(p.jsx)("i",{className:Object(C.t)(P,e,"Editar")})}),!1!==Object(C.s)(P,e,"Remover")&&Object(p.jsx)("button",{className:"action-btn action-delete",title:Object(C.u)(P,e,"Remover"),onClick:()=>M(a.ID),children:Object(p.jsx)("i",{className:Object(C.t)(P,e,"Remover")})})]})}));v(a)},[i,e]);const _=Object(c.useMemo)(()=>[{Header:"C\xf3digo",accessor:"CODIGO",Cell:e=>{let{value:a}=e;return Object(p.jsx)("span",{className:"codigo-badge",children:a})}},{Header:"Designa\xe7\xe3o",accessor:"DESIG",Cell:e=>{let{value:a}=e;return Object(p.jsx)("span",{className:"desig-text",children:a})}},{Header:"Descri\xe7\xe3o",accessor:"OBS_DISPLAY",Cell:e=>{let{value:a}=e;return Object(p.jsx)("span",{className:"desc-truncated",title:a,children:a||"-"})}},{Header:"A\xe7\xf5es",accessor:"action",centered:!0,disableSortBy:!0}],[]),G=function(e){D({show:!0,mode:e,item:arguments.length>1&&void 0!==arguments[1]?arguments[1]:null})},w=()=>{D({show:!1,mode:null,item:null})},F=async e=>{try{return await I.a.delete("/sgigjprpecasprocessual/"+e),u.a.success("Pe\xe7a removida com sucesso"),R(),!0}catch(a){return s("Falha. Tente mais tarde"),!1}},M=e=>{a({delete:F,id:e})};return Object(p.jsxs)("div",{className:"pecas-wrapper",children:[Object(p.jsx)(n.a,{children:Object(p.jsx)(o.a,{sm:12,children:Object(p.jsx)(j.a,{children:Object(p.jsx)(j.a.Body,{children:Object(p.jsx)(A,{columns:_,data:g,modalOpen:()=>G("criar"),loading:h,permissoes:e})})})})}),Object(p.jsx)(N,{show:f.show,mode:f.mode,item:f.item,fields:O,onHide:w,onSave:async e=>{try{if("criar"===f.mode){200===(await I.a.post("/sgigjprpecasprocessual",e)).status&&(u.a.success("Pe\xe7a criada com sucesso"),R(),w())}else if("editar"===f.mode){const a=await I.a.put("/sgigjprpecasprocessual/"+f.item.ID,e);200!==a.status&&204!==a.status||(u.a.success("Pe\xe7a atualizada com sucesso"),R(),w())}}catch(a){a.response&&400===a.response.status?u.a.error(a.response.data.message,{duration:4e3}):u.a.error("Erro ao guardar. Tente mais tarde.",{duration:4e3})}}})]})}}}]);
//# sourceMappingURL=59.fae63026.chunk.js.map
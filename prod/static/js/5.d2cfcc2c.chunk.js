(this["webpackJsonpigj-frontend"]=this["webpackJsonpigj-frontend"]||[]).push([[5],{822:function(e,t,a){"use strict";var s=a(0),c=a(814),o=a(404),l=a(403),n=a(812),i=a(7),r=a(30),d=a(26),j=a(1);t.a=e=>{let{generolist:t,estadocivillist:a,glbgeografialist:u,documentolist:O,contactolist:m,uploadpessoa:b,pessoaopenDO:p}=e;const{popUp_alertaOK:h}=Object(d.a)(),[x,g]=Object(s.useState)(!1),[f,v]=Object(s.useState)(""),[N,I]=Object(s.useState)(""),[D,y]=Object(s.useState)(""),[C,S]=Object(s.useState)(""),[A,E]=Object(s.useState)(""),[_,T]=Object(s.useState)(""),[P,F]=Object(s.useState)(""),[R,L]=Object(s.useState)(""),[w,M]=Object(s.useState)(""),[k,U]=Object(s.useState)(""),[G,q]=Object(s.useState)(""),[B,H]=Object(s.useState)(""),[V,X]=Object(s.useState)(""),[z,J]=Object(s.useState)(""),[K,Q]=Object(s.useState)(""),[W,Y]=Object(s.useState)(!1),[Z,$]=Object(s.useState)(!1),[ee,te]=Object(s.useState)(""),[ae,se]=Object(s.useState)(""),[ce,oe]=Object(s.useState)("");Object(s.useEffect)(()=>{I(""),y(""),S(""),E(""),T(""),F(""),L(""),M(""),U(""),q(""),H(""),X(""),J(""),Q(""),te(""),se(""),oe(""),g(!0),ne("geral"),je([{id:""+Math.random(),tipocontacto:"",contacto:""}]),be([{id:""+Math.random(),tipodocumento:"",numero:"",dataemissao:"",datavalidade:"",anexo:{type:0,file:null}}]),g(p.value)},[p]);const[le,ne]=Object(s.useState)("geral"),ie="nav-link text-reset",re="nav-link text-reset active";var[de,je]=Object(s.useState)([{id:""+Math.random(),tipocontacto:"",contacto:""}]);const[ue,Oe]=Object(s.useState)(!1);var[me,be]=Object(s.useState)([{id:""+Math.random(),tipodocumento:"",numero:"",dataemissao:"",datavalidade:"",anexo:{type:0,file:null}}]);const[pe,he]=Object(s.useState)(!1);async function xe(e){var t={status:!1,file:null};try{const a=new FormData;a.append("file",e);const s={headers:{"content-type":"multipart/form-data"}},c=await r.a.post("/upload",a,s);t={status:!0,file:c},console.log(c)}catch(a){console.error(a.response),t={status:!1,file:null}}return t}return Object(j.jsxs)(c.a,{size:"lg",show:x,onHide:()=>g(!1),children:[Object(j.jsx)(c.a.Header,{style:{border:"0"},closeButton:!0,children:Object(j.jsx)(c.a.Title,{as:"h5",children:"Criar Pessoal"})}),Object(j.jsxs)("ul",{className:"nav nav-tabs profile-tabs nav-fill",id:"myTab",role:"tablist",children:[Object(j.jsx)("li",{className:"nav-item",children:Object(j.jsxs)(i.b,{to:"#",className:"geral"===le?re:ie,onClick:()=>{ne("geral")},id:"profile-tab",children:[Object(j.jsx)("i",{className:"feather icon-user mr-2"}),"Perfil"]})}),Object(j.jsx)("li",{className:"nav-item",children:Object(j.jsxs)(i.b,{to:"#",className:"contactos"===le?re:ie,onClick:()=>{ne("contactos")},id:"contact-tab",children:[Object(j.jsx)("i",{className:"feather icon-phone mr-2"}),"Contactos"]})}),Object(j.jsx)("li",{className:"nav-item",children:Object(j.jsxs)(i.b,{to:"#",className:"documentos"===le?re:ie,onClick:()=>{ne("documentos")},id:"contact-tab",children:[Object(j.jsx)("i",{className:"feather icon-file-text mr-2"}),"Documentos"]})})]}),Object(j.jsxs)(c.a.Body,{style:"documentos"===le?{}:{display:"none"},children:[Object(j.jsx)(o.a,{style:{display:"flex",justifyContent:"flex-end"},sm:12,children:Object(j.jsx)(l.a,{onClick:()=>{be(me.concat([{id:""+Math.random(),tipodocumento:"",numero:"",dataemissao:"",datavalidade:"",anexo:{type:0,file:null}}]))},variant:"primary",children:"+"})}),me.map(e=>{var t;return Object(j.jsxs)(n.a,{style:{marginBottom:"12px"},children:[Object(j.jsx)(o.a,{sm:10,children:Object(j.jsxs)(n.a,{children:[Object(j.jsx)(o.a,{sm:6,children:Object(j.jsxs)("div",{className:"form-group fill",children:[Object(j.jsxs)("label",{className:"floating-label",htmlFor:"Phone",children:["Tipo de Documentos ",Object(j.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(j.jsxs)("select",{onChange:t=>{!function(e,t){"cni"===O.find(t=>t.ID===e).DESIG.toLowerCase()?$(!0):$(!1);const a=me.findIndex(e=>e.id===t);me[a]={id:t,tipodocumento:e,numero:me[a].numero,dataemissao:me[a].dataemissao,datavalidade:me[a].datavalidade,anexo:me[a].anexo},he(!0),be(me.concat([]))}(t.target.value,e.id)},className:"form-control",id:"perfil",required:!0,"aria-required":"true",children:[Object(j.jsx)("option",{hidden:!0,value:"",children:"--- Selecione ---"}),O.map(e=>Object(j.jsx)("option",{value:e.ID,children:e.DESIG},e.ID))]})]})}),Object(j.jsx)(o.a,{sm:3,children:Object(j.jsxs)("div",{className:"form-group fill",children:[Object(j.jsxs)("label",{className:"floating-label",htmlFor:"text",children:["N\xfamero ",Object(j.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(j.jsx)("input",{onChange:t=>{!function(e,t){const a=me.findIndex(e=>e.id===t);me[a]={id:t,numero:e,tipodocumento:me[a].tipodocumento,dataemissao:me[a].dataemissao,datavalidade:me[a].datavalidade,anexo:me[a].anexo},he(!0),be(me.concat([]))}(t.target.value,e.id)},type:"text",className:"form-control"})]})}),Object(j.jsxs)("div",{className:"sm-2 paddinhtop28OnlyPC",children:[Object(j.jsxs)("label",{htmlFor:"anexarcriar"+e.id,className:"btn",style:{backgroundColor:"#d2b32a",color:"#fff"},children:[null==(null===e||void 0===e||null===(t=e.anexo)||void 0===t?void 0:t.file)?Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("i",{className:"feather icon-download"}),Object(j.jsx)(j.Fragment,{children:" Anexar"})]}):"Anexado"," "]}),Object(j.jsx)("input",{id:"anexarcriar"+e.id,onChange:t=>function(e,t){const a=me.findIndex(e=>e.id===t);console.log(me[a]),console.log(t),""!=me[a].tipodocumento&&""!=me[a].numero||h("Preencha o campos obrigat\xf3rios"),me[a]={id:t,tipodocumento:me[a].tipodocumento,dataemissao:me[a].dataemissao,datavalidade:me[a].datavalidade,numero:me[a].numero,anexo:{type:2,file:e}},he(!0),be(me.concat([]))}(t.target.files[0],e.id),accept:"image/x-png,image/jpeg",style:{display:"none"},type:"file"})]}),Z?null:Object(j.jsx)(o.a,{sm:6,children:Object(j.jsxs)("div",{className:"form-group fill",children:[Object(j.jsx)("label",{className:"floating-label",htmlFor:"date",children:"Data de Emiss\xe3o"}),Object(j.jsx)("input",{onChange:t=>{!function(e,t){const a=me.findIndex(e=>e.id===t);me[a]={id:t,dataemissao:e,numero:me[a].numero,tipodocumento:me[a].tipodocumento,datavalidade:me[a].datavalidade,anexo:me[a].anexo},he(!0),be(me.concat([]))}(t.target.value,e.id)},type:"date",className:"form-control"})]})}),Object(j.jsx)(o.a,{sm:6,children:Object(j.jsxs)("div",{className:"form-group fill",children:[Object(j.jsx)("label",{className:"floating-label",htmlFor:"text",children:"Data de Validade"}),Object(j.jsx)("input",{onChange:t=>{!function(e,t){const a=me.findIndex(e=>e.id===t);me[a]={id:t,datavalidade:e,numero:me[a].numero,tipodocumento:me[a].tipodocumento,dataemissao:me[a].dataemissao,anexo:me[a].anexo},he(!0),be(me.concat([]))}(t.target.value,e.id)},type:"date",className:"form-control"})]})})]})}),me.length>1?Object(j.jsx)("div",{className:"paddinhtop66OnlyPC sm-2",children:Object(j.jsx)(l.a,{onClick:()=>function(e){if(me.length>1){const a=me.findIndex(t=>t.id===e);if(a>-1){var t=me;t.splice(a,1),be(t.concat([])),he(!0)}}}(e.id),variant:"danger",children:Object(j.jsx)("i",{className:"feather icon-trash-2"})})}):null]},e.id)})]}),Object(j.jsxs)(c.a.Body,{style:"contactos"===le?{}:{display:"none"},children:[Object(j.jsx)(o.a,{style:{display:"flex",justifyContent:"flex-end"},sm:12,children:Object(j.jsx)(l.a,{onClick:()=>{je(de.concat([{id:""+Math.random(),tipocontacto:"",contacto:""}]))},variant:"primary",children:"+"})}),de.map(e=>Object(j.jsxs)(n.a,{style:{marginBottom:"12px"},children:[Object(j.jsx)(o.a,{sm:5,children:Object(j.jsxs)("div",{className:"form-group fill",children:[Object(j.jsxs)("label",{className:"floating-label",htmlFor:"Phone",children:["Tipo de Contacto ",Object(j.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(j.jsxs)("select",{onChange:t=>{!function(e,t){const a=de.findIndex(e=>e.id===t);de[a]={id:t,tipocontacto:e,contacto:de[a].contacto},Oe(!0),je(de.concat([]))}(t.target.value,e.id)},className:"form-control",id:"perfil",required:!0,"aria-required":"true",children:[Object(j.jsx)("option",{hidden:!0,value:"",children:"--- Selecione ---"}),m.map(e=>Object(j.jsx)("option",{value:e.ID,children:e.DESIG},e.ID))]})]})}),Object(j.jsx)(o.a,{sm:5,children:Object(j.jsxs)("div",{className:"form-group fill",children:[Object(j.jsxs)("label",{className:"floating-label",htmlFor:"text",children:["Contacto ",Object(j.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(j.jsx)("input",{maxLength:"128",onChange:t=>{!function(e,t){const a=de.findIndex(e=>e.id===t);de[a]={id:t,contacto:e,tipocontacto:de[a].tipocontacto},Oe(!0),je(de.concat([]))}(t.target.value,e.id)},type:"text",className:"form-control"})]})}),de.length>1?Object(j.jsx)("div",{className:"sm-2 paddinhtop28OnlyPC",children:Object(j.jsx)(l.a,{onClick:()=>function(e){if(de.length>1){const a=de.findIndex(t=>t.id===e);if(a>-1){var t=de;t.splice(a,1),je(t.concat([])),Oe(!0)}}}(e.id),variant:"danger",children:Object(j.jsx)("i",{className:"feather icon-trash-2"})})}):null]},e.id))]}),Object(j.jsx)(c.a.Body,{style:"geral"===le?{}:{display:"none"},children:Object(j.jsx)("form",{id:"criarpessoa",onSubmit:async function(e){e.preventDefault(),console.log(D);const t={NACIONALIDADE_ID:D,LOCALIDADE_ID:C,PR_ESTADO_CIVIL_ID:A,PR_GENERO_ID:_,NOME:P,DT_NASC:R,ALCUNHA:w,NOME_PAI:k,NOME_MAE:G,OBS:B,ENDERECO:V,ENDERECO_COORD:z,NIF:W?"":K};console.log(t);try{const e=await r.a.post("/sgigjpessoa",t);if("200"==e.status){for(let t=0;t<de.length;t++)if(""!=de[t].tipocontacto&&""!=de[t].contacto){console.log(de);const a={PESSOA_ID:e.data.ID,PR_CONTACTO_TP_ID:de[t].tipocontacto,CONTACTO:de[t].contacto};try{await r.a.post("/sgigjrelcontacto",a)}catch(s){console.error(s.response)}}for(let t=0;t<me.length;t++)if(""!=me[t].tipodocumento&&""!=me[t].numero){console.log(me);var a="";if("2"==me[t].anexo.type){a=(await xe(me[t].anexo.file)).file.data}console.log(a);const c={PESSOA_ID:e.data.ID,PR_DOCUMENTO_TP_ID:me[t].tipodocumento,NUMERO:me[t].numero,DOC_URL:a,DT_EMISSAO:me[t].dataemissao,DT_VALIDADE:me[t].datavalidade};try{await r.a.post("/sgigjreldocumento",c)}catch(s){console.error(s.response)}}b(),g(!1)}}catch(s){try{console.error(s),console.error(s.response),"3058"==s.response.data.code&&h("Esse NIF j\xe1 existe")}catch(c){console.error(c)}}},children:Object(j.jsxs)(n.a,{children:[Object(j.jsx)(o.a,{sm:3,children:Object(j.jsxs)("div",{className:"form-group fill",children:[Object(j.jsxs)("label",{className:"floating-label",htmlFor:"text",children:["C\xf3digo ",Object(j.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(j.jsx)("input",{disabled:!0,value:"0003",type:"text",className:"form-control",id:"Name"})]})}),Object(j.jsx)(o.a,{sm:6,children:Object(j.jsxs)("div",{className:"form-group fill",children:[Object(j.jsxs)("label",{className:"floating-label",htmlFor:"Email",children:["Nome ",Object(j.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(j.jsx)("input",{maxLength:"256",type:"text",onChange:e=>{F(e.target.value)},className:"form-control",id:"Nome ",placeholder:"Nome",required:!0})]})}),Object(j.jsx)(o.a,{sm:3,children:Object(j.jsxs)("div",{className:"form-group fill",children:[Object(j.jsx)("label",{className:"floating-label",htmlFor:"text",children:"Alcunha"}),Object(j.jsx)("input",{type:"text",maxLength:"75",onChange:e=>{M(e.target.value)},className:"form-control",id:"alcunga",placeholder:"Alcunha..."})]})}),Object(j.jsx)(o.a,{sm:4,children:Object(j.jsxs)("div",{className:"form-group fill",children:[Object(j.jsxs)("label",{className:"floating-label",htmlFor:"Phone",children:["G\xeanero ",Object(j.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(j.jsxs)("select",{className:"form-control",onChange:e=>{T(e.target.value)},id:"perfil",required:!0,"aria-required":"true",children:[Object(j.jsx)("option",{hidden:!0,value:"",children:"--- Selecione ---"}),t.map(e=>Object(j.jsx)("option",{value:e.ID,children:e.DESIG},e.ID))]})]})}),Object(j.jsx)(o.a,{sm:4,children:Object(j.jsxs)("div",{className:"form-group fill",children:[Object(j.jsxs)("label",{className:"floating-label",htmlFor:"Phone",children:["Estado civil ",Object(j.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(j.jsxs)("select",{className:"form-control",onChange:e=>{E(e.target.value)},id:"perfil",required:!0,"aria-required":"true",children:[Object(j.jsx)("option",{hidden:!0,value:"",children:"--- Selecione ---"}),a.map(e=>Object(j.jsx)("option",{value:e.ID,children:e.DESIG},e.ID))]})]})}),Object(j.jsx)(o.a,{sm:4,children:Object(j.jsxs)("div",{className:"form-group fill",children:[Object(j.jsxs)("label",{className:"floating-label",htmlFor:"date",children:["Data Nascimento ",Object(j.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(j.jsx)("input",{type:"date",onChange:e=>{L(e.target.value)},className:"form-control",id:"data",required:!0})]})}),Object(j.jsx)(o.a,{sm:6,children:Object(j.jsxs)("div",{className:"form-group fill",children:[Object(j.jsx)("label",{className:"floating-label",htmlFor:"text",children:"Nome Pai"}),Object(j.jsx)("input",{type:"text",maxLength:"128",onChange:e=>{U(e.target.value)},className:"form-control",id:"pai",placeholder:"Nome Pai..."})]})}),Object(j.jsx)(o.a,{sm:6,children:Object(j.jsxs)("div",{className:"form-group fill",children:[Object(j.jsx)("label",{className:"floating-label",htmlFor:"text",children:"Nome M\xe3e"}),Object(j.jsx)("input",{type:"text",maxLength:"128",onChange:e=>{q(e.target.value)},className:"form-control",id:"mae",placeholder:"Nome Mae..."})]})}),Object(j.jsx)(o.a,{sm:6,children:Object(j.jsxs)("div",{className:"form-group fill",children:[Object(j.jsxs)("label",{className:"floating-label",htmlFor:"text",children:["Nacionalidade ",Object(j.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(j.jsxs)("select",{onChange:e=>{y(e.target.value)},className:"form-control",id:"perfil",required:!0,"aria-required":"true",children:[Object(j.jsx)("option",{hidden:!0,value:"",children:"--- Selecione ---"}),u.map(e=>"-1"==e.NIVEL_DETALHE?Object(j.jsx)("option",{value:e.ID,children:e.NACIONALIDADE},e.ID):null)]})]})}),Object(j.jsx)(o.a,{sm:6,children:Object(j.jsxs)("div",{className:"form-group fill",children:[Object(j.jsx)("label",{className:"floating-label",htmlFor:"text",children:"Coordenadas"}),Object(j.jsx)("input",{type:"text",maxLength:"50",onChange:e=>{J(e.target.value)},className:"form-control",id:"coordenada",placeholder:"Endereco Coord..."})]})}),Object(j.jsx)("div",{className:"col-sm-6",children:Object(j.jsxs)("div",{className:"form-group fill",children:[Object(j.jsx)("label",{className:"floating-label",htmlFor:"Address",children:"Endere\xe7o"}),Object(j.jsx)("textarea",{className:"form-control",maxLength:"64000",onChange:e=>{X(e.target.value)},id:"endereco",rows:"3",placeholder:"Endere\xe7o..."})]})}),Object(j.jsx)(o.a,{sm:6,children:Object(j.jsxs)("div",{className:"form-group fill",children:[Object(j.jsxs)("label",{className:"floating-label",htmlFor:"text",children:["NIF ",Object(j.jsx)("span",{style:{color:"red"},children:"*"})]}),W?Object(j.jsx)("input",{readOnly:"readOnly",type:"text",maxLength:"9",onChange:e=>{Q(e.target.value)},className:"form-control",id:"nif",placeholder:"NIF..."}):Object(j.jsx)("input",{type:"text",maxLength:"9",required:!0,onChange:e=>{Q(e.target.value)},className:"form-control",id:"nif",placeholder:"NIF..."}),Object(j.jsxs)("div",{className:" fill mt-2 input-box",children:[Object(j.jsx)("input",{type:"checkbox",name:"",id:"",onChange:e=>Y(e.target.checked)}),Object(j.jsx)("label",{className:"floating-label ml-3",htmlFor:"Name",children:"Sem NIF "})]})]})}),Object(j.jsx)(o.a,{sm:3,children:Object(j.jsxs)("div",{className:"form-group fill",children:[Object(j.jsxs)("label",{className:"floating-label",htmlFor:"text",children:["Ilha ",Object(j.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(j.jsxs)("select",{className:"form-control",id:"perfil",onChange:e=>{var t;t=e.target.value,te(t),se(""),oe(""),S("")},required:!0,"aria-required":"true",children:[Object(j.jsx)("option",{hidden:!0,value:"",children:"--- Selecione ---"}),u.map(e=>"2"==e.NIVEL_DETALHE?Object(j.jsx)("option",{value:e.ID,children:e.ILHA},e.ID):null)]})]})}),Object(j.jsx)(o.a,{sm:3,children:Object(j.jsxs)("div",{className:"form-group fill",children:[Object(j.jsxs)("label",{className:"floating-label",htmlFor:"text",children:["Concelho ",Object(j.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(j.jsxs)("select",{className:"form-control",id:"perfil",onChange:e=>{var t;t=e.target.value,se(t),oe(""),S("")},required:!0,"aria-required":"true",children:[Object(j.jsx)("option",{hidden:!0,value:"",children:"--- Selecione ---"}),u.map(e=>"3"==e.NIVEL_DETALHE&&e.GLB_GEOG_ID==ee?Object(j.jsx)("option",{value:e.ID,children:e.CONCELHO},e.ID):null)]})]})}),Object(j.jsx)(o.a,{sm:3,children:Object(j.jsxs)("div",{className:"form-group fill",children:[Object(j.jsxs)("label",{className:"floating-label",htmlFor:"text",children:["Fregu\xeasia ",Object(j.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(j.jsxs)("select",{className:"form-control",id:"perfil",onChange:e=>{var t;t=e.target.value,oe(t),S("")},required:!0,"aria-required":"true",children:[Object(j.jsx)("option",{hidden:!0,value:"",children:"--- Selecione ---"}),u.map(e=>"4"==e.NIVEL_DETALHE&&e.GLB_GEOG_ID==ae?Object(j.jsx)("option",{value:e.ID,children:e.FREGUESIA},e.ID):null)]})]})}),Object(j.jsx)(o.a,{sm:3,children:Object(j.jsxs)("div",{className:"form-group fill",children:[Object(j.jsxs)("label",{className:"floating-label",htmlFor:"text",children:["Localidade",Object(j.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(j.jsxs)("select",{onChange:e=>{S(e.target.value)},className:"form-control",id:"perfil",required:!0,"aria-required":"true",children:[Object(j.jsx)("option",{hidden:!0,value:"",children:"--- Selecione ---"}),u.map(e=>"5"==e.NIVEL_DETALHE&&e.GLB_GEOG_ID==ce?Object(j.jsx)("option",{value:e.ID,children:e.NOME},e.ID):null)]})]})}),Object(j.jsx)("div",{className:"col-sm-12",children:Object(j.jsxs)("div",{className:"form-group fill",children:[Object(j.jsx)("label",{className:"floating-label",htmlFor:"Address",children:"Obs"}),Object(j.jsx)("textarea",{className:"form-control",maxLength:"64000",onChange:e=>{H(e.target.value)},id:"Address",rows:"3",placeholder:"Obs..."})]})})]})})}),Object(j.jsxs)(c.a.Footer,{children:[Object(j.jsx)(l.a,{variant:"danger",onClick:()=>g(!1),children:"Fechar"}),Object(j.jsx)(l.a,{type:"submit",form:"criarpessoa",variant:"primary",children:"Guardar"})]})]})}},824:function(e,t,a){"use strict";var s=a(0),c=a(404),o=a(403),l=a(812),n=a(818),i=a(30),r=a(26),d=a(1);t.a=e=>{let{documentolist:t,list:a,save:j,item:u,onSendData:O,hidden:m,required:b}=e;const{popUp_alertaOK:p}=Object(r.a)(),[h,x]=Object(s.useState)(!1);var[g,f]=Object(s.useState)([{id:""+Math.random(),tipodocumento:"",numero:"",dataemissao:"",datavalidade:"",anexo:{type:0,file:null}}]);async function v(e){var t={status:!1,file:null};try{const a=new FormData;a.append("file",e);const s={headers:{"content-type":"multipart/form-data"}},c=await i.a.post("/upload",a,s);t={status:!0,file:c},console.log(c)}catch(a){console.error(a),t={status:!1,file:null}}return t}Object(s.useEffect)(()=>{if(0==a.length)x(!0),f([{id:""+Math.random(),tipodocumento:"",numero:"",dataemissao:"",datavalidade:"",anexo:{type:0,file:null}}]);else{x(!1);let e=[];for(let t=0;t<a.length;t++){const s=null!=a[t].DT_EMISSAO?a[t].DT_EMISSAO.substring(0,10):"",c=null!=a[t].DT_VALIDADE?a[t].DT_VALIDADE.substring(0,10):"";e.push({id:""+a[t].ID,tipodocumento:a[t].PR_DOCUMENTO_TP_ID,numero:a[t].NUMERO,dataemissao:s,datavalidade:c,anexo:{type:1,file:a[t].DOC_URL}})}f(e.concat([])),O&&O(g)}console.log(a)},[a]),Object(s.useEffect)(()=>{console.log("ssssssssssssss"+j),""!=u.ID&&null!=u.ID&&async function(){if(1==h){const a=await i.a.delete("/sgigjreldocumento/0?"+(null===u||void 0===u?void 0:u.ENTIDADE)+"="+(null===u||void 0===u?void 0:u.ID));if(console.log(a.status),"200"==a.status||"204"==a.status){console.log(a);for(let a=0;a<g.length;a++)if(""!=g[a].tipodocumento&&(!m&&""!=g[a].numero||m)){console.log(g);var e="";"1"==g[a].anexo.type&&(e=g[a].anexo.file),"2"==g[a].anexo.type&&(e=(await v(g[a].anexo.file)).file.data),console.log(e);const s={[null===u||void 0===u?void 0:u.ENTIDADE]:null===u||void 0===u?void 0:u.ID,PR_DOCUMENTO_TP_ID:g[a].tipodocumento,NUMERO:m?1:g[a].numero,DOC_URL:e,DT_EMISSAO:g[a].dataemissao,DT_VALIDADE:g[a].datavalidade};try{await i.a.post("/sgigjreldocumento",s)}catch(t){console.error(t.response)}}}}}()},[j]);const[N,I]=Object(s.useState)(0);return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(c.a,{style:{display:"flex",justifyContent:"flex-end"},sm:12,children:Object(d.jsx)(o.a,{onClick:()=>(f(g.concat([{id:""+Math.random(),tipodocumento:"",numero:"",dataemissao:"",datavalidade:"",anexo:{type:0,file:null}}])),void(O&&O(g))),variant:"primary",children:"+"})}),g.map((e,a)=>{var s;if(a==N)return Object(d.jsxs)(l.a,{style:{marginBottom:"12px"},children:[Object(d.jsx)(c.a,{sm:10,children:Object(d.jsxs)(l.a,{children:[Object(d.jsx)(c.a,{sm:6,children:Object(d.jsxs)("div",{className:"form-group fill",children:[Object(d.jsxs)("label",{className:"floating-label",htmlFor:"Phone",children:["Tipo de Documentos"," ",b&&Object(d.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(d.jsxs)("select",{defaultValue:e.tipodocumento,onChange:t=>{!function(e,t){const a=g.findIndex(e=>e.id===t);g[a]={id:t,tipodocumento:e,numero:g[a].numero,dataemissao:g[a].dataemissao,datavalidade:g[a].datavalidade,anexo:g[a].anexo},x(!0),f(g.concat([])),O&&O(g)}(t.target.value,e.id)},className:"form-control",id:"perfil",required:b,"aria-required":"true",children:[Object(d.jsx)("option",{hidden:!0,value:"",children:"--- Selecione ---"}),t.map(e=>Object(d.jsx)("option",{value:e.ID,children:e.DESIG},e.ID))]})]})}),!m&&Object(d.jsx)(c.a,{sm:3,children:Object(d.jsxs)("div",{className:"form-group fill",children:[Object(d.jsx)("label",{className:"floating-label",htmlFor:"text",children:"N\xfamero   "}),Object(d.jsx)("input",{defaultValue:e.numero,onChange:t=>{!function(e,t){const a=g.findIndex(e=>e.id===t);g[a]={id:t,numero:e,tipodocumento:g[a].tipodocumento,dataemissao:g[a].dataemissao,datavalidade:g[a].datavalidade,anexo:g[a].anexo},x(!0),f(g.concat([])),O&&O(g)}(t.target.value,e.id)},type:"text",className:"form-control"})]})}),Object(d.jsxs)("div",{className:"sm-2 paddinhtop28OnlyPC",children:[Object(d.jsxs)("label",{htmlFor:"anexareditar"+e.id,className:"btn",style:{backgroundColor:"#d2b32a",color:"#fff"},children:[null==(null===e||void 0===e||null===(s=e.anexo)||void 0===s?void 0:s.file)?Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("i",{className:"feather icon-download"}),Object(d.jsx)(d.Fragment,{children:" Anexar"})]}):"Anexado"," "]}),Object(d.jsx)("input",{id:"anexareditar"+e.id,style:{display:"none"},onChange:t=>function(e,t,a){const s=g.findIndex(e=>e.id===t);if(console.log(g[s]),console.log(t),""==g[s].tipodocumento)return p("Preencha o campos obrigat\xf3rios"),void(a.target.value="");g[s]={id:t,tipodocumento:g[s].tipodocumento,dataemissao:g[s].dataemissao,datavalidade:g[s].datavalidade,numero:g[s].numero,anexo:{type:2,file:e}},x(!0),f(g.concat([])),O&&O(g)}(t.target.files[0],e.id,t),accept:m?void 0:"image/x-png,image/jpeg,.mp4",type:"file"})]}),!m&&Object(d.jsx)(c.a,{sm:6,children:Object(d.jsxs)("div",{className:"form-group fill",children:[Object(d.jsx)("label",{className:"floating-label",htmlFor:"date",children:"Data de Emiss\xe3o"}),Object(d.jsx)("input",{defaultValue:e.dataemissao,onChange:t=>{!function(e,t){const a=g.findIndex(e=>e.id===t);g[a]={id:t,dataemissao:e,numero:g[a].numero,tipodocumento:g[a].tipodocumento,datavalidade:g[a].datavalidade,anexo:g[a].anexo},x(!0),f(g.concat([])),O&&O(g)}(t.target.value,e.id)},type:"date",className:"form-control"})]})}),!m&&Object(d.jsx)(c.a,{sm:6,children:Object(d.jsxs)("div",{className:"form-group fill",children:[Object(d.jsx)("label",{className:"floating-label",htmlFor:"text",children:"Data de Validade"}),Object(d.jsx)("input",{defaultValue:e.datavalidade,onChange:t=>{!function(e,t){const a=g.findIndex(e=>e.id===t);g[a]={id:t,datavalidade:e,numero:g[a].numero,tipodocumento:g[a].tipodocumento,dataemissao:g[a].dataemissao,anexo:g[a].anexo},x(!0),f(g.concat([])),O&&O(g)}(t.target.value,e.id)},type:"date",className:"form-control"})]})})]})}),g.length>1?Object(d.jsx)("div",{className:"paddinhtop66OnlyPC sm-2",children:Object(d.jsx)(o.a,{onClick:()=>function(e){if(g.length>1){const a=g.findIndex(t=>t.id===e);if(a>-1){var t=g;t.splice(a,1),f(t.concat([])),O&&O(g),x(!0)}}}(e.id),variant:"danger",children:Object(d.jsx)("i",{className:"feather icon-trash-2"})})}):null]},e.id)}),Object(d.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:Object(d.jsxs)(n.a,{className:"justify-content-end",children:[Object(d.jsx)(n.a.First,{onClick:()=>I(0)}),Object(d.jsx)(n.a.Prev,{onClick:()=>I(N>0?N-1:0)}),Object(d.jsx)("span",{style:{display:"flex",padding:"8px 20px",alignItems:"center",justifyContent:"center"},children:N+1}),Object(d.jsx)(n.a.Next,{onClick:()=>I(N>=g.length-1?g.length-1:N+1)}),Object(d.jsx)(n.a.Last,{onClick:()=>I(g.length-1)})]})})]})}},825:function(e,t,a){"use strict";var s=a(0),c=a(814),o=a(812),l=a(404),n=a(403),i=a(7),r=a(1);t.a=e=>{let{Open:t,setOpen:a,list:d}=e;const[j,u]=Object(s.useState)(""),[O,m]=Object(s.useState)("");return Object(s.useEffect)(()=>{u("")},[d]),Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)(c.a,{size:"lg",show:t,onHide:()=>a(!1),children:[Object(r.jsx)(c.a.Body,{children:Object(r.jsx)(o.a,{children:Object(r.jsxs)(l.a,{xl:12,className:"task-detail-right",children:[Object(r.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"spaceAround"},children:Object(r.jsxs)("span",{style:{paddingBottom:"4px",cursor:"pointer",borderBottom:"2px solid #d2b32a",width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(r.jsx)("i",{className:"feather icon-file-text m-r-5"}),"Anexos"]})}),Object(r.jsxs)("div",{style:{width:"100%",height:"500px"},children:[Object(r.jsx)("div",{style:{width:"100%",borderBottom:"1px solid #d2b32a",paddingTop:"20px",paddingBottom:"20px",marginBottom:"20px",overflow:"auto",height:"70px"},children:"undefined"!=typeof d?d.map(e=>{var t;return Object(r.jsx)(i.b,{onClick:()=>{var t,a,s,c;"PDF"==(null===(t=e.DOC_URL)||void 0===t?void 0:t.substring((null===(a=e.DOC_URL)||void 0===a?void 0:a.lastIndexOf("."))+1))||"pdf"==(null===(s=e.DOC_URL)||void 0===s?void 0:s.substring((null===(c=e.DOC_URL)||void 0===c?void 0:c.lastIndexOf("."))+1))?m(e.DOC_URL):u(e.DOC_URL)},style:{margin:"2px"},to:"#",className:"mb-1 text-muted d-flex align-items-end text-h-primary",children:"::"+(null===e||void 0===e||null===(t=e.sgigjprdocumentotp)||void 0===t?void 0:t.DESIG)},e.ID)}):null}),Object(r.jsx)("div",{style:{width:"100%",display:j?"flex":"none",justifyContent:"center",marginBottom:"10px"},children:Object(r.jsxs)("span",{children:[Object(r.jsx)("i",{className:"feather icon-eye m-r-5"}),"Pr\xe9-vizualiza\xe7\xe3o"]})}),Object(r.jsx)("a",{style:{display:j?"block":"none"},href:j+"?alt=media&token=0",target:"_blank",rel:"noopener noreferrer",children:Object(r.jsx)("div",{className:""==j?"previewdoc":"previewdoc-img",style:{backgroundImage:'url("'+j+'?alt=media&token=0")',height:"350px"}})})]})]})})}),Object(r.jsx)(c.a.Footer,{children:Object(r.jsx)(n.a,{variant:"danger",onClick:()=>a(!1),children:"Fechar"})})]}),Object(r.jsx)(c.a,{size:"xl",show:O,onHide:()=>{m(null),setTimeout(()=>a(!0),150)},children:Object(r.jsx)("iframe",{height:1e3,src:O+"?alt=media&token=0",title:"pdf-viewer",width:"100%s"})})]})}},828:function(e,t,a){},829:function(e,t,a){"use strict";var s=a(0),c=a.n(s),o=a(812),l=a(404),n=a(403),i=a(814),r=a(7),d=a(76),j=a(30),u=a(8),O=a(807),m=a(26),b=a(1);var p=e=>{let{uploadlist:t,voltar:a,InterrompidoTipo:c,setInterrompidoTipo:r,INSTRUCAO_ID:d}=e;const[p,h]=Object(s.useState)(!1),[x,g]=Object(s.useState)(""),{popUp_alertaOK:f}=Object(m.a)(),[v,N]=Object(s.useState)([]),[I,D]=Object(s.useState)(-1),[y,C]=Object(s.useState)([{id:Date.now(),tipodocumento:"",numero:"",dataemissao:"",datavalidade:"",anexo:{type:0,file:null},main:""}]),[S,A]=Object(s.useState)(!1),[E,_]=Object(s.useState)(!1);Object(s.useEffect)(()=>{h(""!==c),async function(){try{const e=await j.a.get("/sgigjprdocumentotp");"200"==e.status&&N(e.data)}catch(e){console.error(e.response)}}()},[c]);const T=(e,t,a)=>{C(s=>s.map(s=>s.id===e?Object(u.a)(Object(u.a)({},s),{},{[t]:a}):s)),A(!0)};async function P(e){var t={status:!1,file:null};try{const a=new FormData;a.append("file",e);const s={headers:{"content-type":"multipart/form-data"}};t={status:!0,file:await j.a.post("/upload",a,s)}}catch(a){console.error(a.response),t={status:!1,file:null}}return t}return Object(b.jsxs)(i.a,{size:"lg",show:p,onHide:()=>h(!1),children:[Object(b.jsx)(i.a.Header,{closeButton:!0,children:Object(b.jsx)(i.a.Title,{as:"h5",children:"A"===c?"Arquivar":"Prescrever"})}),Object(b.jsx)(i.a.Body,{children:Object(b.jsxs)("form",{id:"GO",onSubmit:async e=>{e.preventDefault();let s=!1,o=[];try{for(let e=0;e<y.length;e++){if(console.log("pkoko",y[e]),!y[e].anexo||null==y[e].anexo.file)return void f("Por favor anexa documento");if(1!==v.find(t=>t.ID===y[e].tipodocumento).IDENTIFICACAO||""!=y[e].datavalidade&&""!=y[e].numero&&""!=y[e].dataemissao){if(""!=y[e].tipodocumento&&""!=y[e].numero){var l="";if("1"==y[e].anexo.type&&(l=y[e].anexo.file),"2"==y[e].anexo.type){l=(await P(y[e].anexo.file)).file.data}const t={PR_DOCUMENTO_TP_ID:y[e].tipodocumento,NUMERO:y[e].numero,DOC_URL:l,DT_EMISSAO:y[e].dataemissao,DT_VALIDADE:y[e].datavalidade,ESTADO:"1",MAIN:y[e].main};if(o.push(t),s){_(!1),f("Preenche os campos que representam um documento de identifica\xe7\xe3o");break}}}else s=!0}try{200===(await j.a.put("/sgigjrelprocessoinstrucao/".concat(d,"/interrompido"),{OBS:x,TIPO:c,documentos:o})).status&&(r(""),t(),a())}catch(n){console.error(n.response)}}catch(n){console.error(n.response)}},children:[Object(b.jsx)(o.a,{children:Object(b.jsx)(l.a,{sm:12,children:Object(b.jsxs)(O.a.Group,{children:[Object(b.jsxs)(O.a.Label,{children:["Justifica\xe7\xe3o ",Object(b.jsx)("span",{className:"text-danger",children:"*"})]}),Object(b.jsx)(O.a.Control,{as:"textarea",rows:3,style:{height:"250px"},required:!0,value:x,onChange:e=>g(e.target.value),placeholder:"Justifica\xe7\xe3o..."})]})})}),y.map((e,t)=>{const a=v.find(t=>t.ID===parseInt(e.tipodocumento,10)),s=1===(null===a||void 0===a?void 0:a.IDENTIFICACAO);return Object(b.jsxs)(o.a,{className:"mb-3",children:[Object(b.jsx)(l.a,{sm:12,children:Object(b.jsxs)(o.a,{children:[Object(b.jsx)(l.a,{sm:4,children:Object(b.jsxs)(O.a.Group,{children:[Object(b.jsxs)(O.a.Label,{children:["Tipo de Documento"," ",Object(b.jsx)("span",{className:"text-danger",children:"*"})]}),Object(b.jsxs)(O.a.Control,{as:"select",required:!0,onChange:t=>T(e.id,"tipodocumento",t.target.value),children:[Object(b.jsx)("option",{hidden:!0,value:"",children:"--- Selecione ---"}),v.map(e=>Object(b.jsx)("option",{value:e.ID,children:e.DESIG},e.ID))]})]})}),Object(b.jsx)(l.a,{sm:4,children:Object(b.jsxs)(O.a.Group,{children:[Object(b.jsxs)(O.a.Label,{children:["N\xfamero ",Object(b.jsx)("span",{className:"text-danger",children:"*"})]}),Object(b.jsx)(O.a.Control,{required:!0,type:"text",onChange:t=>T(e.id,"numero",t.target.value)})]})}),Object(b.jsxs)(l.a,{sm:4,className:"d-flex",style:{alignItems:"center",paddingTop:"20px"},children:[Object(b.jsxs)(n.a,{style:{backgroundColor:"#d2b32a",color:"#fff"},as:"label",htmlFor:"anexar".concat(e.id),children:[" ",e.anexo.file?"Anexado":"Anexar"," "]}),Object(b.jsx)(O.a.Control,{type:"file",id:"anexar".concat(e.id),style:{display:"none"},accept:"image/png,image/jpeg",onChange:t=>((e,t)=>{const a=y.find(t=>t.id===e);a.tipodocumento&&a.numero?T(e,"anexo",{type:2,file:t}):f("Preencha os campos obrigat\xf3rios")})(e.id,t.target.files[0])}),Object(b.jsx)(O.a.Check,{style:{marginLeft:"10px",paddingTop:"-100px"},inline:!0,type:"radio",name:"documento",onChange:()=>D(t),label:"Usar este"})]}),Object(b.jsx)(l.a,{sm:6,children:Object(b.jsxs)(O.a.Group,{children:[Object(b.jsxs)(O.a.Label,{children:["Data de Emiss\xe3o"," ",s&&Object(b.jsx)("span",{className:"text-danger",children:"*"})]}),Object(b.jsx)(O.a.Control,{type:"date",required:s,onChange:t=>T(e.id,"dataemissao",t.target.value)})]})}),Object(b.jsx)(l.a,{sm:6,children:Object(b.jsxs)(O.a.Group,{children:[Object(b.jsxs)(O.a.Label,{children:["Data de Validade"," ",s&&Object(b.jsx)("span",{className:"text-danger",children:"*"})]}),Object(b.jsx)(O.a.Control,{type:"date",required:s,onChange:t=>T(e.id,"datavalidade",t.target.value)})]})})]})}),y.length>1&&Object(b.jsx)(l.a,{sm:2,className:"d-flex align-items-center",children:Object(b.jsx)(n.a,{variant:"danger",onClick:()=>{return t=e.id,void(y.length>1&&C(y.filter(e=>e.id!==t)));var t},children:Object(b.jsx)("i",{className:"feather icon-trash-2"})})})]},e.id)}),Object(b.jsx)(n.a,{variant:"secondary",onClick:()=>{C([...y,{id:Date.now(),tipodocumento:"",numero:"",dataemissao:"",datavalidade:"",anexo:{type:0,file:null},main:""}])},children:"Adicionar Documento"})]})}),Object(b.jsxs)(i.a.Footer,{children:[Object(b.jsx)(n.a,{type:"submit",form:"GO",variant:"primary",children:"A"===c?"Arquivar":"Prescrever"}),Object(b.jsx)(n.a,{variant:"danger",onClick:()=>h(!1),children:"Fechar"})]})]})},h=a(240),x=a.n(h),g=a(820),f=a.n(g);(new Date).toISOString().slice(0,10);var v=a(817),N=a(816);var I=e=>{let{data:t}=e;const a=c.a.useMemo(()=>[{Header:"Pe\xe7as Processual",accessor:"PECAS"},{Header:"Data",accessor:"DATA2"},{Header:"Anexos",accessor:"ANEXOS"},{Header:"A\xe7\xf5es",accessor:"action"}],[]),{getTableProps:s,getTableBodyProps:o,headerGroups:l,prepareRow:n,page:i,setPageSize:r,state:{pageIndex:d,pageSize:j}}=Object(N.useTable)({columns:a,data:t,initialState:{pageIndex:0,pageSize:Number.MAX_VALUE}},N.useGlobalFilter,N.useSortBy,N.usePagination);return Object(b.jsxs)(v.a,Object(u.a)(Object(u.a)({striped:!0,bordered:!0,hover:!0,responsive:!0},s()),{},{children:[Object(b.jsx)("thead",{children:l.map(e=>Object(b.jsx)("tr",Object(u.a)(Object(u.a)({},e.getHeaderGroupProps()),{},{children:e.headers.map(e=>Object(b.jsxs)("th",Object(u.a)(Object(u.a)({},e.getHeaderProps(e.getSortByToggleProps())),{},{children:[e.render("Header"),Object(b.jsx)("span",{children:e.isSorted?e.isSortedDesc?Object(b.jsx)("span",{className:"feather icon-arrow-down text-muted float-right"}):Object(b.jsx)("span",{className:"feather icon-arrow-up text-muted float-right"}):""})]})))})))}),Object(b.jsx)("tbody",Object(u.a)(Object(u.a)({},o()),{},{children:i.map((e,t)=>(n(e),Object(b.jsx)("tr",Object(u.a)(Object(u.a)({},e.getRowProps()),{},{children:e.cells.map(e=>Object(b.jsx)("td",Object(u.a)(Object(u.a)({},e.getCellProps()),{},{children:e.render("Cell")})))}))))}))]}))},D=a(825),y=a(821),C=a(822),S=a(824);function A(e){let{k:t,value:a,set:c}=e;const[o,n]=Object(s.useState)([]);return Object(s.useEffect)(()=>{!async function(){try{const e=await j.a.get("/sgigjprdecisaotp");"200"==e.status&&n(e.data)}catch(e){console.error(e.response)}}()}),Object(b.jsx)(l.a,{sm:12,children:Object(b.jsxs)("div",{className:"form-group fill",children:[Object(b.jsxs)("label",{className:"floating-label",htmlFor:"Name",children:["Decis\xe3o ",Object(b.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(b.jsxs)("select",{value:a,className:"form-control",onChange:e=>{c(t,e.target.value)},id:"perfil",required:!0,"aria-required":"true",children:[Object(b.jsx)("option",{hidden:!0,value:"",children:"--- Selecione ---"}),o.map(e=>Object(b.jsx)("option",{value:e.ID,children:e.DESIG},e.ID))]})]})})}function E(e){let{k:t,value:a,set:c}=e;const[o,n]=Object(s.useState)([]);return Object(s.useEffect)(()=>{!async function(){try{const e=await j.a.get("/sgigjinfracaocoima");"200"==e.status&&n(e.data)}catch(e){console.error(e.response)}}()},[]),Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(l.a,{sm:8,children:Object(b.jsxs)("div",{className:"form-group fill",children:[Object(b.jsx)("label",{className:"floating-label",htmlFor:"Name",children:"Infra\xe7\xe3o"}),Object(b.jsxs)("select",{id:"perfil",value:null===a||void 0===a?void 0:a.INFRACAO,onChange:e=>{c(t,Object(u.a)(Object(u.a)({},a),{},{INFRACAO:e.target.value}))},className:"form-control",required:!0,"aria-required":"true",children:[Object(b.jsx)("option",{hidden:!0,value:"",children:"--- Selecione ---"}),o.map(e=>{var t;return Object(b.jsx)("option",{value:e.ID,children:null===e||void 0===e||null===(t=e.sgigjprinfracaotp)||void 0===t?void 0:t.DESIG},e.ID)})]})]})}),Object(b.jsx)(l.a,{sm:4,children:Object(b.jsxs)("div",{className:"form-group fill",children:[Object(b.jsx)("label",{className:"floating-label",htmlFor:"Name",children:"Coima "}),Object(b.jsx)("input",{maxLength:"128",type:"number",onChange:e=>{c(t,Object(u.a)(Object(u.a)({},a),{},{COIMA:e.target.value}))},defaultValue:null===a||void 0===a?void 0:a.COIMA,className:"form-control",placeholder:"Valor...",required:!0})]})})]})}function _(e){let{k:t,value:a,set:c,documentolist:o,selected_relinstrucaopeca:n,ID_C:i,documentosgeral_lista_save:r,required:d=!0}=e;const[j,u]=Object(s.useState)([]);return Object(s.useEffect)(()=>{u(null==n?[]:n.sgigjreldocumento)},[n]),Object(b.jsx)(l.a,{sm:12,children:Object(b.jsx)(S.a,{required:d,documentolist:o,list:j,save:r,item:null==n?{ID:i,ENTIDADE:"REL_INSTRUTOR_PECAS_ID"}:{ID:n.ID,ENTIDADE:"REL_INSTRUTOR_PECAS_ID"},hidden:!0})})}function T(e){let{k:t,value:a,set:s,obsRef:c}=e;return Object(b.jsx)(l.a,{sm:12,children:Object(b.jsx)("div",{className:"form-group fill",children:Object(b.jsx)(f.a,{value:a,config:{readonly:!1},ref:c})})})}function P(e){let{k:t,value:a,set:c,selected_relinstrucaopeca:o,pessoalist:i,documentolist:r}=e;const[d,u]=Object(s.useState)([]),[O,m]=Object(s.useState)([]),[p,h]=Object(s.useState)([]),[x,g]=Object(s.useState)([]),[f,v]=Object(s.useState)({code:0,value:!1}),[N,I]=Object(s.useState)([]);return Object(s.useEffect)(()=>{I(i),console.log(o),async function(){try{const e=await j.a.get("/sgigjprgenero");"200"==e.status&&u(e.data)}catch(e){console.error(e.response)}}(),async function(){try{const e=await j.a.get("/sgigjprestadocivil");"200"==e.status&&m(e.data)}catch(e){console.error(e.response)}}(),async function(){try{const e=await j.a.get("/glbgeografia");"200"==e.status&&h(e.data)}catch(e){console.error(e.response)}}(),async function(){try{const e=await j.a.get("/sgigjprcontactotp");"200"==e.status&&g(e.data)}catch(e){console.error(e.response)}}()},[]),Object(b.jsxs)(l.a,{sm:12,children:[Object(b.jsxs)("label",{className:"floating-label",htmlFor:"text",children:["Pessoa ",Object(b.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(b.jsxs)("div",{style:{display:"flex"},children:[Object(b.jsx)("div",{className:"form-group fill",style:{width:"100%"},children:Object(b.jsx)(y.a,{className:"basic-single",classNamePrefix:"select",onChange:e=>c(t,e.value),name:"pessoa",options:N,value:N.map(e=>e.ID==a?e:null),required:!0,menuPlacement:"auto",menuPosition:"fixed",placeholder:"Pessoa..."})}),Object(b.jsx)(n.a,{onClick:()=>v({code:f.code+1,value:!0}),style:{marginLeft:"8px",height:"38px"},variant:"primary",children:Object(b.jsx)("i",{className:"feather icon-plus"})})]}),Object(b.jsx)(C.a,{generolist:d,estadocivillist:O,glbgeografialist:p,documentolist:r,contactolist:x,pessoaopenDO:f,uploadpessoa:async function(){try{const t=await j.a.get("/sgigjpessoa");if("200"==t.status){for(var e=0;e<t.data.length;e++)t.data[e].value=t.data[e].ID,t.data[e].label=t.data[e].NOME;I(t.data)}}catch(t){console.error(t.response)}}})]})}function F(e){var t;let{DATA:a,peca:c,selected_relinstrucaopeca:i,pessoalist:r,documentolist:d,setdocumentosgeral_lista:O,item:p,uploadinstrucaopecaslist:h,setselected_relinstrucaopeca:g}=e;const[f,v]=Object(s.useState)(!1),[N,I]=Object(s.useState)(""),[D,y]=Object(s.useState)({}),{popUp_alertaOK:C}=Object(m.a)(),S=Object(s.useRef)();function F(e,t){y(Object(u.a)(Object(u.a)({},D),{},{[e]:t}))}function R(e){if(e)return"1"==e.FLAG_ANEXO_DOC?"ANEXO_DOC":"1"==e.FLAG_DECISAO?"DECISAO":"1"==e.FLAG_DESTINATARIO?"DESTINATARIO":"1"==e.FLAG_INFRACAO_COIMA?"INFRACAO_COIMA":"1"==e.FLAG_OBS?"OBS":"1"==e.FLAG_PERIODO_EXCLUSAO?"PERIODO_EXCLUSAO":"1"==e.FLAG_PESSOA?"PESSOA":"1"==e.FLAG_TEXTO?"TEXTO":void 0}Object(s.useEffect)(()=>{y({DESTINATARIO:(null===i||void 0===i?void 0:i.DESTINATARIO_ID)||"",PESSOA:(null===i||void 0===i?void 0:i.PESSOA_TESTEMUNHA_ID)||"",COIMA:(null===i||void 0===i?void 0:i.COIMA)||"",OBS:(null===i||void 0===i?void 0:i.OBS)||(null===c||void 0===c?void 0:c.OBS)||"",DECISAO:(null===i||void 0===i?void 0:i.PR_DECISAO_TP_ID)||"",INFRACAO_COIMA:null}),S.current&&(S.current.value=(null===i||void 0===i?void 0:i.OBS)||(null===c||void 0===c?void 0:c.OBS)||"")},[i,c]);const L=(null===c||void 0===c||null===(t=c.sgigjrelpecaprocessualcampo)||void 0===t?void 0:t.map(e=>({key:R(e.sigjprcampo),value:D[R(e.sigjprcampo)],ORDEM:e.ORDEM,required:1==e.FLAG_OBRIGATORIEDADE})).sort((e,t)=>e.ORDEM-t.ORDEM))||[];return Object(b.jsx)("form",{id:"itemGO",onSubmit:async function(e){if(e.preventDefault(),""==a)C("Escolha uma data");else try{var t,s,o;const e={REL_PROCESSO_INSTRUCAO_ID:null===p||void 0===p?void 0:p.sgigjprocessodespacho[0].sgigjrelprocessoinstrutor[0].sgigjrelprocessoinstrucao[0].ID,PR_PECAS_PROCESSUAIS_ID:c.ID,PESSOA_TESTEMUNHA_ID:D.PESSOA||null,DESTINATARIO_ID:D.DESTINATARIO||null,PR_DECISAO_TP_ID:D.DECISAO||null,INFRACAO_COIMA_ID:(null===(t=D.INFRACAO_COIMA)||void 0===t?void 0:t.INFRACAO)||null,COIMA:(null===(s=D.INFRACAO_COIMA)||void 0===s?void 0:s.COIMA)||null,DATA:a,OBS:(null===S||void 0===S||null===(o=S.current)||void 0===o?void 0:o.value)||""};if(console.log(e),null==i){const t=await j.a.post("/sgigjrelinstrutorpeca",e);if("200"==t.status){I(t.data.ID),v(!f);const e=await h();if(1==e.done)for(let a=0;a<e.list.length;a++){const s=e.list[a];s.ID==t.data.ID&&g(s)}}}else{"200"==(await j.a.put("/sgigjrelinstrutorpeca/"+i.ID,e)).status&&(x.a.success("Documento Guardado!",{duration:4e3}),v(!f),h())}}catch(l){console.error(l)}},children:c&&Object(b.jsxs)(o.a,{children:[L.map(e=>((e,t,a,s,c,o,l,n,i,r)=>{switch(e){case"PESSOA":case"DESTINATARIO":return Object(b.jsx)(P,{k:e,set:a,value:t,selected_relinstrucaopeca:s,pessoalist:c,documentolist:o});case"OBS":case"TEXTO":case"PERIODO_EXCLUSAO":return Object(b.jsx)(T,{k:e,set:a,value:t,obsRef:i});case"ANEXO_DOC":return Object(b.jsx)(_,{k:e,set:a,value:t,selected_relinstrucaopeca:s,pessoalist:c,documentolist:o,documentosgeral_lista_save:l,ID_C:n,required:r});case"INFRACAO_COIMA":return Object(b.jsx)(E,{k:e,set:a,value:t});case"DECISAO":return Object(b.jsx)(A,{k:e,set:a,value:t});default:return}})(e.key,e.value,F,i,r,d,f,N,S,e.required)),Object(b.jsxs)(l.a,{sm:12,style:{display:"flex",justifyContent:"flex-end",marginTop:"10px",gridGap:"15px"},children:[null!=i&&Object(b.jsxs)(b.Fragment,{children:[null!=i.URL_DOC&&Object(b.jsxs)("a",{href:(null===i||void 0===i?void 0:i.URL_DOC)+"?alt=media&token=0",target:"_blank",children:[Object(b.jsx)(n.a,{variant:"primary",children:"Abrir DOC Gerado"})," "]}),Object(b.jsx)(n.a,{onClick:()=>async function(){try{if("200"==(await j.a.put("/sgigjrelinstrutorpeca/"+(null===i||void 0===i?void 0:i.ID)+"/despacho",{})).status){const e=await h();if(1==e.done)for(let t=0;t<e.list.length;t++){const a=e.list[t];a.ID==(null===i||void 0===i?void 0:i.ID)&&g(a)}}}catch(e){console.error(e.response)}}(),variant:"primary",children:"Gerar DOC"})]}),Object(b.jsx)(n.a,{type:"submit",form:"itemGO",variant:"primary",children:"Guardar"})]})]})})}t.a=e=>{var t,a,u;let{item:O,setinstrucaoitem:h,uploadlist:x,instrucaoitem:g,decisaolist:f}=e;const{popUp_removerItem:v,popUp_alertaOK:N}=Object(m.a)(),[y,C]=Object(s.useState)(""),[S,A]=Object(s.useState)([]),[E,_]=Object(s.useState)(""),[T,P]=Object(s.useState)({}),[R,L]=Object(s.useState)([]);const[w,M]=Object(s.useState)([]);const[k,U]=Object(s.useState)([]),[G,q]=Object(s.useState)(""),[B,H]=Object(s.useState)("");async function V(){let e={done:!1,list:[]};if(ce()){const n=O.sgigjprocessodespacho[0].sgigjrelprocessoinstrutor[0].sgigjrelprocessoinstrucao[0].ID;q(n),H(O.sgigjprocessodespacho[0].sgigjrelprocessoinstrutor[0].ID);try{const l=await j.a.get("/sgigjrelinstrutorpeca?REL_PROCESSO_INSTRUCAO_ID="+n);if("200"==l.status){for(var t=0;t<l.data.length;t++){var a,s,o;const e=l.data[t].ID,n=l.data[t];l.data[t].id=l.data[t].ID,l.data[t].DATA2=Object(d.f)(l.data[t].DATA),l.data[t].PECAS=l.data[t].sgigjprpecasprocessual.DESIG,null==l.data[t].FLAG_NOTA_COMUNICACAO?l.data[t].QUEM="------------------":("1"==l.data[t].FLAG_NOTA_COMUNICACAO&&(l.data[t].QUEM="Visado"),"2"==l.data[t].FLAG_NOTA_COMUNICACAO&&(l.data[t].QUEM="Entidade Decisora"),"3"==l.data[t].FLAG_NOTA_COMUNICACAO&&(l.data[t].QUEM="Entidade Visada")),!n.sgigjreldocumento&&null!==(a=l.data[t])&&void 0!==a&&a.URL_DOC&&(n.sgigjreldocumento=[]),n.sgigjreldocumento.push({DOC_URL:null===(s=l.data[t])||void 0===s?void 0:s.URL_DOC,sgigjprdocumentotp:{DESIG:"Documento Gerado"}}),null===(o=l.data[t])||void 0===o||o.sgigjreldocumento.length,l.data[t].ANEXOS=Object(b.jsx)(c.a.Fragment,{children:Object(b.jsx)(r.b,{to:"#",onClick:()=>se(n),children:Object(b.jsx)("i",{className:"feather icon-file"})})}),l.data[t].action=Object(b.jsxs)(c.a.Fragment,{children:[Object(b.jsx)(r.b,{to:"#",onClick:()=>ie(n),className:"text-primary mx-1",children:Object(b.jsx)("i",{className:"text-primary feather icon-edit"})}),Object(b.jsx)(r.b,{to:"#",onClick:()=>je(e),className:"text-danger",children:Object(b.jsx)("i",{className:"feather icon-trash-2"})})]})}e={done:!0,list:l.data},U(l.data)}}catch(l){console.error(l.response)}}return e}const[X,z]=Object(s.useState)(""),[J,K]=Object(s.useState)("*"),[Q,W]=Object(s.useState)(""),[Y,Z]=Object(s.useState)(""),[$,ee]=Object(s.useState)(!1),[te,ae]=Object(s.useState)([]);function se(e){ee(!0),console.log("sgigjreldocumento",null===e||void 0===e?void 0:e.sgigjreldocumento),ae(null===e||void 0===e?void 0:e.sgigjreldocumento)}function ce(){if(null!=O)return O.sgigjprocessodespacho.length>0&&(O.sgigjprocessodespacho[0].sgigjrelprocessoinstrutor.length>0&&O.sgigjprocessodespacho[0].sgigjrelprocessoinstrutor[0].sgigjrelprocessoinstrucao.length>0)}async function oe(){x(),h(null)}const[le,ne]=Object(s.useState)("");function ie(e){ne(e)}function re(e){return E==e||function(e){if(k.findIndex(t=>t.PR_PECAS_PROCESSUAIS_ID===e)>=0&&"6b4729e2b01da73d490dc1b04671ea570d49"==e)return!1;if(k.findIndex(t=>t.PR_PECAS_PROCESSUAIS_ID===e)>=0&&"0a2557ff1b8e966ae041183b8bbcb4d2ce1d"==e)return!1;let t=0;if("4ce0c01543457df12a96bc3eac9492e81657"==e){for(let e=0;e<k.length;e++)null!=k[e].FLAG_NOTA_COMUNICACAO&&t++;if(t>=3)return!1}return!0}(e)}Object(s.useEffect)(()=>{null!=le&&(_(le.PR_PECAS_PROCESSUAIS_ID),z(le.PESSOA_TESTEMUNHA_ID),K(le.REF),W(Object(d.e)(le.DATA)),Z(le.OBS))},[le]),Object(s.useEffect)(()=>{null!=E&&P(S.find(e=>e.ID==E))},[E]),Object(s.useEffect)(()=>{!async function(){try{const e=await j.a.get("/sgigjprpecasprocessual");"200"==e.status&&A(e.data)}catch(e){console.error(e.response)}}(),async function(){try{const t=await j.a.get("/sgigjpessoa");if("200"==t.status){for(var e=0;e<t.data.length;e++)t.data[e].value=t.data[e].ID,t.data[e].label=t.data[e].NOME;L(t.data)}}catch(t){console.error(t.response)}}(),async function(){try{const e=await j.a.get("/sgigjprdocumentotp");"200"==e.status&&M(e.data)}catch(e){console.error(e.response)}}(),V()},[]);const de=async e=>{let t=!0;try{await j.a.delete("/sgigjrelinstrutorpeca/"+e)}catch(a){t=!1,console.error(a.response),N("Falha. Tente mais tarde")}return V(),t},je=async e=>{v({delete:de,id:e})};const[ue,Oe]=Object(s.useState)(),[me,be]=Object(s.useState)(!1);return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(o.a,{className:"mb-3",children:Object(b.jsx)(l.a,{className:"d-flex align-items-center",style:{fontSize:"16px"},children:"Instru\xe7\xe3o do Processo"})}),ce()?Object(b.jsxs)(o.a,{children:[Object(b.jsx)(l.a,{sm:2,children:Object(b.jsxs)("div",{className:"form-group fill",children:[Object(b.jsxs)("label",{className:"floating-label",htmlFor:"Name",children:["Refer\xeancia ",Object(b.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(b.jsx)("input",{disabled:!0,type:"text",className:"form-control",id:"Name",value:J,required:!0})]})}),Object(b.jsx)(l.a,{sm:7,children:Object(b.jsxs)("div",{className:"form-group fill",children:[Object(b.jsxs)("label",{className:"floating-label",htmlFor:"Name",children:["Pe\xe7a Processual ",Object(b.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(b.jsxs)("select",{value:E,onChange:e=>{var t;t=e.target.value,ne(null),_(t),z(""),K("*"),W(""),Z("")},className:"form-control",id:"pessoa",required:!0,"aria-required":"true",children:[Object(b.jsx)("option",{hidden:!0,value:"",children:"--- Selecione ---"}),S.map(e=>re(e.ID)&&Object(b.jsx)("option",{title:e.CODIGO,value:e.ID,children:e.DESIG},e.ID))]})]})}),Object(b.jsx)(l.a,{sm:3,children:Object(b.jsxs)("div",{className:"form-group fill",children:[Object(b.jsxs)("label",{className:"floating-label",htmlFor:"Name",children:["Data ",Object(b.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(b.jsx)("input",{type:"date",onChange:e=>{W(e.target.value)},value:Q,className:"form-control",placeholder:"Data...",required:!0})]})})]}):Object(b.jsx)("div",{className:"form-group fill",style:{display:"flex",padding:"50px 0px",width:"100%",justifyContent:"center"},children:Object(b.jsx)(n.a,{variant:"primary",onClick:()=>async function(){const e={PROCESSO_DESPACHO_ID:O.sgigjprocessodespacho[0].ID};try{if("200"==(await j.a.post("/sgigjrelprocessoinstrucao",e)).status){const e=await j.a.get("/sgigjprocessoexclusao/"+O.id);"200"==e.status&&e.data.length>0&&(e.data[0].id=e.data[0].ID,h(e.data[0]))}}catch(t){console.error(t.response)}}(),children:"Iniciar Instru\xe7\xe3o"})}),Object(b.jsx)(F,{DATA:Q,PESSOA_TESTEMUNHA_ID:X,setPESSOA_TESTEMUNHA_ID:z,OBS:Y,setOBS:Z,item:O,uploadinstrucaopecaslist:V,PECAselected:E,selected_relinstrucaopeca:le,setselected_relinstrucaopeca:ne,pessoalist:R,documentolist:w,peca:T}),Object(b.jsx)("br",{}),ce()&&Object(b.jsx)(I,{data:k}),Object(b.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"10px",gridGap:"10px"},children:[ce()&&Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(n.a,{onClick:()=>async function(e){try{console.log("GO_ER");const a=await j.a.get("/juntada/"+e);if("200"==a.status){const e=a.data.buffer.data,s=new Uint8Array(e).buffer;var t=new Blob([s],{type:"application/pdf"});const c=URL.createObjectURL(t);Oe(c),be(!0),V()}}catch(a){console.error(a)}}(O.sgigjprocessodespacho[0].sgigjrelprocessoinstrutor[0].sgigjrelprocessoinstrucao[0].ID),variant:"primary",children:"Juntada"}),Object(b.jsx)(n.a,{variant:"primary",onClick:()=>C("A"),children:"Arquivar"}),Object(b.jsx)(n.a,{variant:"primary",onClick:()=>C("P"),children:"Prescrever"}),Object(b.jsx)(n.a,{variant:"primary",onClick:()=>async function(){try{"200"==(await j.a.put("/sgigjrelprocessoinstrucao/"+O.sgigjprocessodespacho[0].sgigjrelprocessoinstrutor[0].sgigjrelprocessoinstrucao[0].ID,{TIPO:"concluir"})).status&&(x(),N("Instruc\xe3o conclu\xedda"),h(null))}catch(a){var e,t;console.error(a.response),"567785636745684"==(null===a||void 0===a||null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.code)&&N("S\xf3 \xe9 poss\xedvel concluir essa instru\xe7\xe3o, ap\xf3s inser\xe7\xe3o de pe\xe7a Relatorio Final")}}(),children:"Concluir Instru\xe7\xe3o do Processo"})]}),Object(b.jsx)(n.a,{variant:"danger",onClick:()=>oe(),children:"Voltar"})]}),Object(b.jsx)(D.a,{Open:$,setOpen:ee,list:te}),Object(b.jsx)(i.a,{size:"xl",show:me,onHide:()=>be(!1),children:Object(b.jsx)("iframe",{height:1e3,src:"".concat(ue),title:"pdf-viewer",width:"100%s"})}),Object(b.jsx)(p,{voltar:oe,INSTRUCAO_ID:null===O||void 0===O||null===(t=O.sgigjprocessodespacho[0])||void 0===t||null===(a=t.sgigjrelprocessoinstrutor[0])||void 0===a||null===(u=a.sgigjrelprocessoinstrucao[0])||void 0===u?void 0:u.ID,InterrompidoTipo:y,setInterrompidoTipo:C,uploadlist:x})]})}}}]);
//# sourceMappingURL=5.d2cfcc2c.chunk.js.map
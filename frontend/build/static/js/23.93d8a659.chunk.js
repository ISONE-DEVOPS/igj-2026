(this["webpackJsonpigj-frontend"]=this["webpackJsonpigj-frontend"]||[]).push([[23],{909:function(e,a,t){"use strict";t(0);var s=t(864),c=t(865),i=t(1);a.a=e=>{let{title:a,value:t,icon:l,color:o,subtitle:n,change:r,sparklineData:d,loading:b,format:j}=e;const h={chart:{type:"area",height:40,sparkline:{enabled:!0},animations:{enabled:!0,easing:"easeinout",speed:800}},stroke:{curve:"smooth",width:2},fill:{type:"gradient",gradient:{shadeIntensity:1,opacityFrom:.4,opacityTo:.1,stops:[0,100]}},colors:[o||"#2B7FB9"],tooltip:{enabled:!1}},m=d?[{name:a,data:d.map(e=>e.total||e)}]:[];return b?Object(i.jsx)(s.a,{className:"kpi-card",children:Object(i.jsx)(s.a.Body,{children:Object(i.jsxs)("div",{className:"kpi-skeleton",children:[Object(i.jsx)("div",{className:"skeleton-line skeleton-title"}),Object(i.jsx)("div",{className:"skeleton-line skeleton-value"}),Object(i.jsx)("div",{className:"skeleton-line skeleton-sparkline"})]})})}):Object(i.jsx)(s.a,{className:"kpi-card",style:{borderLeft:"4px solid ".concat(o||"#2B7FB9")},children:Object(i.jsxs)(s.a.Body,{className:"p-3",children:[Object(i.jsxs)("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[Object(i.jsxs)("div",{children:[Object(i.jsx)("p",{className:"kpi-title mb-0",children:a}),Object(i.jsx)("h3",{className:"kpi-value mb-0",children:(p=t||0,"currency"===j?p>=1e6?"".concat((p/1e6).toFixed(1),"M CVE"):p>=1e3?"".concat((p/1e3).toFixed(0),"K CVE"):"".concat(Number(p).toLocaleString("pt-CV")," CVE"):"percent"===j?"".concat(p,"%"):p>=1e6?"".concat((p/1e6).toFixed(1),"M"):p>=1e3?"".concat((p/1e3).toFixed(0),"K"):Number(p).toLocaleString("pt-CV"))})]}),Object(i.jsx)("div",{className:"kpi-icon",style:{color:o||"#2B7FB9"},children:Object(i.jsx)("i",{className:l})})]}),n&&Object(i.jsxs)("p",{className:"kpi-subtitle mb-1",children:[void 0!==r&&Object(i.jsxs)("span",{className:"kpi-change ".concat(r>=0?"positive":"negative"),children:[Object(i.jsx)("i",{className:"feather ".concat(r>=0?"icon-trending-up":"icon-trending-down")})," ",Math.abs(r),"%"]})," ",n]}),d&&d.length>1&&Object(i.jsx)("div",{className:"kpi-sparkline",children:Object(i.jsx)(c.a,{options:h,series:m,type:"area",height:40})})]})});var p}},910:function(e,a,t){"use strict";t(0);var s=t(864),c=t(1);a.a=e=>{let{title:a,subtitle:t,children:i,loading:l,height:o}=e;return l?Object(c.jsxs)(s.a,{className:"chart-card",children:[Object(c.jsx)(s.a.Header,{className:"chart-card-header",children:Object(c.jsx)("div",{className:"skeleton-line skeleton-title",style:{width:"60%"}})}),Object(c.jsx)(s.a.Body,{className:"chart-card-body",children:Object(c.jsx)("div",{className:"chart-skeleton",style:{height:o||300},children:Object(c.jsx)("div",{className:"skeleton-chart-placeholder"})})})]}):Object(c.jsxs)(s.a,{className:"chart-card",children:[Object(c.jsxs)(s.a.Header,{className:"chart-card-header",children:[Object(c.jsx)("h6",{className:"chart-card-title mb-0",children:a}),t&&Object(c.jsx)("small",{className:"chart-card-subtitle",children:t})]}),Object(c.jsx)(s.a.Body,{className:"chart-card-body p-2",children:i})]})}},961:function(e,a,t){},992:function(e,a,t){"use strict";t.r(a);var s=t(0),c=t(807),i=t(403),l=t(812),o=t(404),n=t(865),r=t(908),d=t.n(r),b=t(837),j=t(30),h=t(26),m=t(909),p=t(910);const x=e=>{if(!e||!e.length)return null;return{options:{chart:{type:"bar",height:320,toolbar:{show:!1},animations:{enabled:!0,easing:"easeinout",speed:600}},plotOptions:{bar:{borderRadius:4,columnWidth:"55%"}},colors:["#FF8C00"],xaxis:{categories:e.map(e=>(e=>{const[a,t]=e.split("-");return"".concat(["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"][parseInt(t)-1]," ").concat(a.slice(2))})(e.mes)),labels:{style:{colors:"#636E72",fontSize:"11px"},rotateAlways:!1}},yaxis:{labels:{style:{colors:"#636E72",fontSize:"11px"}},forceNiceScale:!0},grid:{borderColor:"#f1f1f1",strokeDashArray:3},tooltip:{y:{formatter:e=>"".concat(e," reclamacao(oes)")}},dataLabels:{enabled:!1}},series:[{name:"Reclamacoes",data:e.map(e=>e.total)}]}};const g=e=>e&&e.length?{options:{chart:{type:"bar",height:320,toolbar:{show:!1},animations:{enabled:!0,easing:"easeinout",speed:600}},plotOptions:{bar:{borderRadius:4,horizontal:!0,barHeight:"60%"}},colors:["#1B4965"],xaxis:{labels:{style:{colors:"#636E72",fontSize:"11px"}},forceNiceScale:!0},yaxis:{labels:{style:{colors:"#636E72",fontSize:"11px"},maxWidth:160}},grid:{borderColor:"#f1f1f1",strokeDashArray:3},tooltip:{y:{formatter:e=>"".concat(e," reclamacao(oes)")}},dataLabels:{enabled:!0,style:{fontSize:"11px",colors:["#fff"]}}},series:[{name:"Reclamacoes",data:e.map(e=>({x:e.entidade,y:e.total}))}]}:null;const O=e=>e&&e.length?{options:{chart:{type:"bar",height:320,toolbar:{show:!1},animations:{enabled:!0,easing:"easeinout",speed:600}},plotOptions:{bar:{borderRadius:4,columnWidth:"45%"}},colors:["#C5A55A"],xaxis:{categories:e.map(e=>String(e.ano)),labels:{style:{colors:"#636E72",fontSize:"11px"}}},yaxis:{labels:{style:{colors:"#636E72",fontSize:"11px"}},forceNiceScale:!0},grid:{borderColor:"#f1f1f1",strokeDashArray:3},tooltip:{y:{formatter:e=>"".concat(e," reclamacao(oes)")}},dataLabels:{enabled:!0,style:{fontSize:"12px",colors:["#1B4965"]},offsetY:-20}},series:[{name:"Reclamacoes",data:e.map(e=>e.total)}]}:null;var u=t(76),f=(t(961),t(1));a.default=()=>{const{permissoes:e}=Object(h.a)(),[a,t]=Object(s.useState)(null),[r,N]=Object(s.useState)(!0),[v,y]=Object(s.useState)(""),[k,S]=Object(s.useState)(!1),C=Object(s.useRef)(null),w=Array.from({length:(new Date).getFullYear()-2022+1},(e,a)=>2022+a),F=Object(s.useCallback)(async()=>{N(!0);try{const e={};v&&(e.ano=v);const a=await j.a.get("/reclamacao/estatisticas",{params:e});t(a.data)}catch(e){console.error("Erro ao carregar estatisticas:",e)}N(!1)},[v]);Object(s.useEffect)(()=>{F()},[F]);const E=a?x(a.porMes):null,z=a?g(a.porEntidade):null,A=a?O(a.porAno):null,B=Object(s.useCallback)(async()=>{if(C.current){S(!0);try{const e=C.current,a=await d()(e,{scale:1.5,useCORS:!0,logging:!1,backgroundColor:"#F5F7FA"}),t=new b.a("l","mm","a4"),s=t.internal.pageSize.getWidth(),c=t.internal.pageSize.getHeight(),i=10;t.setFontSize(14),t.setTextColor(27,73,101),t.text("SGIGJ - Estatisticas SGIGJ",i,12),t.setFontSize(9),t.setTextColor(99,110,114);const l=(new Date).toLocaleDateString("pt-CV",{day:"2-digit",month:"2-digit",year:"numeric"});t.text("Exportado em ".concat(l),s-i-40,12);const o=a.toDataURL("image/png"),n=s-2*i,r=a.height*n/a.width;let j=18;const h=c-j-i;if(r<=h)t.addImage(o,"PNG",i,j,n,r);else{let e=0;const s=a.width,c=h*s/n;for(;e<a.height;){e>0&&(t.addPage(),j=i);const l=Math.min(c,a.height-e),o=document.createElement("canvas");o.width=s,o.height=l;o.getContext("2d").drawImage(a,0,e,s,l,0,0,s,l);const r=o.toDataURL("image/png"),d=l*n/s;t.addImage(r,"PNG",i,j,n,d),e+=l}}t.save("estatisticas-sgigj-".concat(l.replace(/\//g,"-"),".pdf"))}catch(e){console.error("Erro ao exportar PDF:",e)}S(!1)}},[]);return Object(u.l)("/processos/reclamacao/estatisticas",e)?Object(f.jsxs)("div",{className:"reclamacao-stats",children:[Object(f.jsxs)("div",{className:"stats-header",children:[Object(f.jsx)("h4",{children:"Estatisticas SGIGJ"}),Object(f.jsxs)("div",{className:"stats-actions",children:[Object(f.jsxs)(c.a.Control,{as:"select",className:"filter-select",size:"sm",value:v,onChange:e=>y(e.target.value),children:[Object(f.jsx)("option",{value:"",children:"Todos os anos"}),w.map(e=>Object(f.jsx)("option",{value:e,children:e},e))]}),Object(f.jsx)(i.a,{variant:"outline-secondary",size:"sm",onClick:F,disabled:r,children:Object(f.jsx)("i",{className:"fas fa-sync-alt"})}),Object(f.jsxs)(i.a,{variant:"outline-primary",size:"sm",onClick:B,disabled:k||r,children:[Object(f.jsx)("i",{className:"fas fa-file-pdf"})," ",k?"A exportar...":"PDF"]})]})]}),Object(f.jsxs)("div",{ref:C,children:[Object(f.jsxs)(l.a,{className:"mb-4",children:[Object(f.jsx)(o.a,{lg:3,sm:6,className:"mb-3",children:Object(f.jsx)(m.a,{title:"Total Reclamacoes",value:(null===a||void 0===a?void 0:a.total)||0,icon:"fas fa-exclamation-circle",color:"#FF8C00",loading:r})}),Object(f.jsx)(o.a,{lg:3,sm:6,className:"mb-3",children:Object(f.jsx)(m.a,{title:"Ano Corrente",value:(null===a||void 0===a?void 0:a.totalAnoCorrente)||0,icon:"fas fa-calendar",color:"#2B7FB9",subtitle:"".concat((new Date).getFullYear()),loading:r})}),Object(f.jsx)(o.a,{lg:3,sm:6,className:"mb-3",children:Object(f.jsx)(m.a,{title:"Media Mensal",value:(null===a||void 0===a?void 0:a.mediaMensal)||0,icon:"fas fa-chart-line",color:"#C5A55A",loading:r})}),Object(f.jsx)(o.a,{lg:3,sm:6,className:"mb-3",children:Object(f.jsx)(m.a,{title:"Top Entidade",value:(null===a||void 0===a?void 0:a.topEntidade)||"-",icon:"fas fa-building",color:"#1B4965",loading:r})})]}),Object(f.jsxs)(l.a,{className:"mb-4",children:[Object(f.jsx)(o.a,{lg:8,className:"mb-3",children:Object(f.jsx)(p.a,{title:"Evolucao Mensal",subtitle:"Reclamacoes por mes",loading:r,children:E?Object(f.jsx)(n.a,{options:E.options,series:E.series,type:"bar",height:320,width:"100%"}):Object(f.jsxs)("div",{className:"empty-state",children:[Object(f.jsx)("i",{className:"fas fa-chart-bar"}),Object(f.jsx)("p",{children:"Sem dados disponiveis"})]})})}),Object(f.jsx)(o.a,{lg:4,className:"mb-3",children:Object(f.jsx)(p.a,{title:"Por Ano",subtitle:"Distribuicao anual",loading:r,children:A?Object(f.jsx)(n.a,{options:A.options,series:A.series,type:"bar",height:320,width:"100%"}):Object(f.jsxs)("div",{className:"empty-state",children:[Object(f.jsx)("i",{className:"fas fa-chart-bar"}),Object(f.jsx)("p",{children:"Sem dados disponiveis"})]})})})]}),Object(f.jsx)(l.a,{children:Object(f.jsx)(o.a,{lg:12,className:"mb-3",children:Object(f.jsx)(p.a,{title:"Top Entidades",subtitle:"Entidades com mais reclamacoes",loading:r,children:z?Object(f.jsx)(n.a,{options:z.options,series:z.series,type:"bar",height:320,width:"100%"}):Object(f.jsxs)("div",{className:"empty-state",children:[Object(f.jsx)("i",{className:"fas fa-building"}),Object(f.jsx)("p",{children:"Sem dados disponiveis"})]})})})})]})]}):Object(f.jsx)("div",{className:"reclamacao-stats",children:Object(f.jsxs)("div",{className:"empty-state",children:[Object(f.jsx)("i",{className:"fas fa-lock"}),Object(f.jsx)("p",{children:"Sem permissao para aceder a esta pagina."})]})})}}}]);
//# sourceMappingURL=23.93d8a659.chunk.js.map